apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-provisioning
data:
  datasource.yml: |
    apiVersion: 1
    datasources:
      - name: Prometheus
        type: prometheus
        access: proxy
        url: http://prometheus.yts-monitoring.svc.cluster.local:9090
        isDefault: true
  dashboard.yml: |
    apiVersion: 1
    providers:
      - name: yts
        orgId: 1
        folder: YouTube Success ML
        type: file
        disableDeletion: false
        editable: true
        options:
          path: /var/lib/grafana/dashboards
  yts-api-observability.json: |
    {
      "id": null,
      "uid": "yts-api-k8s",
      "title": "YTS API K8s Observability",
      "schemaVersion": 39,
      "version": 1,
      "refresh": "10s",
      "panels": [
        {
          "type": "timeseries",
          "title": "Request Count",
          "id": 1,
          "gridPos": { "h": 8, "w": 24, "x": 0, "y": 0 },
          "targets": [{ "expr": "http_requests_total", "refId": "A" }]
        }
      ],
      "templating": { "list": [] },
      "annotations": { "list": [] }
    }
